<%= turbo_stream.update "track-form" do %>
  
  <% if @track_form.step == "info" %>
    <%= form_with model: @track_form, url: tracks_path(), class: 'direct-upload' do |form| %>
      <%= form.text_field :step %>
      <%= form.fields_for :tracks do |ff| %>
        <%= ff.label :title %>
        <%= ff.text_field :title %>
        <%= ff.file_field :cover %>
        <%= ff.text_field :audio, value: ff.object.audio.signed_id %>
      <% end %>
    
      <%= form.submit %>
    <% end %>
  <% end %>

  <% if @track_form.step == "share" %>
    <%= render partial: "share_form_track", collection: @track_form.tracks, as: :track %>
  <% end %>

<% end %>